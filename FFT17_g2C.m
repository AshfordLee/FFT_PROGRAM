%% 清除环境
clear;
clc;

%% 定义符号变量
syms x omega;
% 如有需要，可添加单位根假设，例如：assume(omega^17 == 1);

%% 定义化简后的余式 val(x)
% 利用 ω^17=1 的周期性，原余式
%   ω + x*(ω^1594323+ω^19683+ω^243+ω^3) + ω^81+ω^6561+ω^531441
%   + x^2*(ω^4782969+ω^59049+ω^729+ω^9) + x^3*(ω^14348907+ω^177147+ω^2187+ω^27)
% 化简得到：
%
% 常数项：
%    ω^(1)       = ω
%    ω^(81)      = ω^(3^4)  = ω^13
%    ω^(6561)    = ω^(3^8)  = ω^16
%    ω^(531441)  = ω^(3^12) = ω^4
%
% x 的系数：
%    ω^(1594323) = ω^(3^13) = ω^12
%    ω^(19683)   = ω^(3^9)  = ω^14
%    ω^(243)     = ω^(3^5)  = ω^5
%    ω^(3)       = ω^3
%
% x^2 的系数：
%    ω^(4782969) = ω^(3^14) = ω^2
%    ω^(59049)   = ω^(3^10) = ω^8
%    ω^(729)     = ω^(3^6)  = ω^15
%    ω^(9)       = ω^(3^2)  = ω^9
%
% x^3 的系数：
%    ω^(14348907)= ω^(3^15) = ω^6
%    ω^(177147)  = ω^(3^11) = ω^7
%    ω^(2187)    = ω^(3^7)  = ω^11
%    ω^(27)      = ω^(3^3)  = ω^10
%
% 故有：
A0 = omega + omega^13 + omega^16 + omega^4;
A1 = omega^12 + omega^14 + omega^5 + omega^3;
A2 = omega^2 + omega^8 + omega^15 + omega^9;
A3 = omega^6 + omega^7 + omega^11 + omega^10;

%% 构造 x^4-1 的伴随矩阵 C
% 对于多项式 p(x)=x^4-1，系数为 [1, 0, 0, 0, -1]，故其伴随矩阵为：
%     [ 0   0   0   1 ]
%     [ 1   0   0   0 ]
%     [ 0   1   0   0 ]
%     [ 0   0   1   0 ]
C = sym([0 0 0 1;
         1 0 0 0;
         0 1 0 0;
         0 0 1 0]);

%% 计算 val(C)
% 将 val(x) 展开为 A0 + A1*x + A2*x^2 + A3*x^3，
% 则替换 x 为矩阵 C 得：
% val(C) = A0*I + A1*C + A2*C^2 + A3*C^3
I = sym(eye(4));  % 4×4 单位矩阵
valC = A0*I + A1*C + A2*C^2 + A3*C^3;

%% 显示结果
disp('val(C) = ');
pretty(valC)
